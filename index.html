// Função real para salvar dados no Gist
async function saveDataToGist() {
    try {
        updateSyncStatus('Sincronizando...', true);
        
        const dataToSave = {
            weightData: weightData,
            exerciseData: exerciseData,
            nextId: nextId,
            lastUpdated: new Date().toISOString()
        };
        
        const response = await fetch('https://api.github.com/gists' + (GIST_ID ? `/${GIST_ID}` : ''), {
            method: GIST_ID ? 'PATCH' : 'POST',
            headers: {
                'Authorization': `token ${GITHUB_TOKEN}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                description: 'Dados do Emagrecimento Marcelo',
                public: false,
                files: {
                    [GIST_FILENAME]: {
                        content: JSON.stringify(dataToSave, null, 2)
                    }
                }
            })
        });
        
        const result = await response.json();
        
        if (!GIST_ID) {
            localStorage.setItem('emagrecimentoMarceloGistId', result.id);
        }
        
        updateSyncStatus('Sincronizado', true);
        showSaveNotification();
        
        return true;
    } catch (error) {
        console.error('Erro ao salvar no Gist:', error);
        updateSyncStatus('Erro na sincronização', false);
        return false;
    }
}

// Função real para carregar dados do Gist
async function loadDataFromGist() {
    try {
        updateSyncStatus('Carregando...', true);
        
        if (!GIST_ID) return false;
        
        const response = await fetch(`https://api.github.com/gists/${GIST_ID}`, {
            headers: {
                'Authorization': `token ${GITHUB_TOKEN}`
            }
        });
        
        const result = await response.json();
        const fileContent = result.files[GIST_FILENAME].content;
        const parsedData = JSON.parse(fileContent);
        
        weightData = parsedData.weightData || [];
        exerciseData = parsedData.exerciseData || [];
        nextId = parsedData.nextId || 1;
        
        updateSyncStatus('Sincronizado', true);
        return true;
    } catch (error) {
        console.error('Erro ao carregar do Gist:', error);
        updateSyncStatus('Erro no carregamento', false);
        return false;
    }
}